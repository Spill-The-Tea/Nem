#include <stdio.h>
#include <iostream>
#include <chrono>
#include <iomanip>
#include "test.h"

using namespace std;

uint64_t perft(position &pos, int depth) {
	if (depth == 0) return 1;
	Move move;
	uint64_t result = 0;
	Move * moves = pos.GenerateMoves<ALL>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	return result;
}

uint64_t perft1(position &pos, int depth) {
	if (depth == 0) return 1;
	Move move;
	uint64_t result = 0;
	Move * moves = pos.GenerateMoves<TACTICAL>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	moves = pos.GenerateMoves<QUIETS>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	return result;
}

uint64_t perft2(position &pos, int depth) {
	if (depth == 0) return 1;
	Move move;
	uint64_t result = 0;
	Move * moves = pos.GenerateMoves<WINNING_CAPTURES>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	moves = pos.GenerateMoves<EQUAL_CAPTURES>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	moves = pos.GenerateMoves<LOOSING_CAPTURES>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	moves = pos.GenerateMoves<QUIETS>();
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) result += perft(next, depth - 1);
		++moves;
	}
	return result;
}

void divide(position &pos, int depth) {
	Move * moves = pos.GenerateMoves<ALL>();
	Move move;
	uint64_t total = 0;
	while ((move = *moves)) {
		position next = position(pos);
		if (next.ApplyMove(move)) {
			uint64_t p = perft(next, depth - 1);
			cout << toString(move) << "\t" << p << "\t" << next.fen() << endl;
			total += p;
		}
		++moves;
	}
	cout << "Total: " << total << endl;
}

uint64_t perftNodes = 0;
chrono::microseconds perftRuntime;
bool checkPerft(string fen, int depth, uint64_t expectedResult) {
	position pos(fen);
	chrono::system_clock::time_point begin = chrono::high_resolution_clock::now();
	uint64_t perftResult = perft(pos, depth);
	chrono::system_clock::time_point end = chrono::high_resolution_clock::now();
	auto runtime = end - begin;
	chrono::microseconds runtimeMS = chrono::duration_cast<chrono::microseconds>(runtime);
	perftRuntime += runtimeMS;
	perftNodes += expectedResult;
	if (perftResult == expectedResult) {
		if (runtimeMS.count() > 0) {
			cout << "OK\t" << depth << "\t" << perftResult << "\t" << runtimeMS.count() / 1000 << " ms\t" << expectedResult / runtimeMS.count() << " MNodes/s\t" << fen << endl;
		}
		else {
			cout << "OK\t" << depth << "\t" << perftResult << "\t" << runtimeMS.count() / 1000 << " ms\t" << fen << endl;
		}
		return true;
	}
	else {
		cout << "Error\t" << depth << "\t" << perftResult << "\texpected\t" << expectedResult << "\t" << fen << endl;
		return false;
	}
}

bool testPerft() {
	bool result = true;
	perftRuntime = perftRuntime.zero();
	//Chess960 positions
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 1, 19);
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 2, 361);
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 3, 7735);
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 4, 164966);
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 5, 3962549);
	result = result && checkPerft("nrbkqbnr/pppppppp/8/8/8/8/PPPPPPPP/NRBKQBNR w KQkq - 0 1", 6, 94328606);
	result = result && checkPerft("rn2k1r1/ppp1pp1p/3p2p1/5bn1/P7/2N2B2/1PPPPP2/2BNK1RR w Gkq - 4 11", 1, 33);
	result = result && checkPerft("rn2k1r1/ppp1pp1p/3p2p1/5bn1/P7/2N2B2/1PPPPP2/2BNK1RR w Gkq - 4 11", 2, 1072);
	result = result && checkPerft("rn2k1r1/ppp1pp1p/3p2p1/5bn1/P7/2N2B2/1PPPPP2/2BNK1RR w Gkq - 4 11", 3, 35141);
	result = result && checkPerft("rn2k1r1/ppp1pp1p/3p2p1/5bn1/P7/2N2B2/1PPPPP2/2BNK1RR w Gkq - 4 11", 4, 1111449);
	result = result && checkPerft("rn2k1r1/ppp1pp1p/3p2p1/5bn1/P7/2N2B2/1PPPPP2/2BNK1RR w Gkq - 4 11", 5, 37095094);
	result = result && checkPerft("2rkr3/5PP1/8/5Q2/5q2/8/5pp1/2RKR3 w KQkq - 0 1", 5, 94370149);
	result = result && checkPerft("rqkrbnnb/pppppppp/8/8/8/8/PPPPPPPP/RQKRBNNB w KQkq - 0 1", 6, 111825069);
	//Standard Chess positions
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 1, 20);
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 2, 400);
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 3, 8902);
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 4, 197281);
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 5, 4865609);
	result = result && checkPerft("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", 6, 119060324);
	result = result && checkPerft("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 1", 1, 48);
	result = result && checkPerft("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 1", 2, 2039);
	result = result && checkPerft("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 1", 3, 97862);
	result = result && checkPerft("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 1", 4, 4085603);
	result = result && checkPerft("r3k2r/p1ppqpb1/bn2pnp1/3PN3/1p2P3/2N2Q1p/PPPBBPPP/R3K2R w KQkq - 0 1", 5, 193690690);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 1, 15);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 2, 66);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 3, 1197);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 4, 7059);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 5, 133987);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R w K - 0 1", 6, 764643);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 1, 16);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 2, 71);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 3, 1287);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 4, 7626);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 5, 145232);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 w Q - 0 1", 6, 846648);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 1, 5);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 2, 75);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 3, 459);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 4, 8290);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 5, 47635);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 w k - 0 1", 6, 899442);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 1, 5);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 2, 80);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 3, 493);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 4, 8897);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 5, 52710);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 w q - 0 1", 6, 1001523);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 1, 26);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 2, 112);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 3, 3189);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 4, 17945);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 5, 532933);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R w KQ - 0 1", 6, 2788982);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 1, 5);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 2, 130);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 3, 782);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 4, 22180);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 5, 118882);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 w kq - 0 1", 6, 3517770);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 1, 12);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 2, 38);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 3, 564);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 4, 2219);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 5, 37735);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R w K - 0 1", 6, 185867);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 1, 15);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 2, 65);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 3, 1018);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 4, 4573);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 5, 80619);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 w Q - 0 1", 6, 413018);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 1, 3);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 2, 32);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 3, 134);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 4, 2073);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 5, 10485);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 w k - 0 1", 6, 179869);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 1, 4);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 2, 49);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 3, 243);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 4, 3991);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 5, 20780);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 w q - 0 1", 6, 367724);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 1, 26);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 2, 568);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 3, 13744);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 4, 314346);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 5, 7594526);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R w KQkq - 0 1", 6, 179862938);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 1, 25);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 2, 567);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 3, 14095);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 4, 328965);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 5, 8153719);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R w Kkq - 0 1", 6, 195629489);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 1, 25);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 2, 548);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 3, 13502);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 4, 312835);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 5, 7736373);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R w Kkq - 0 1", 6, 184411439);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 1, 25);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 2, 547);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 3, 13579);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 4, 316214);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 5, 7878456);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 w Qkq - 0 1", 6, 189224276);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 1, 26);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 2, 583);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 3, 14252);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 4, 334705);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 5, 8198901);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 6, 198328929);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 1, 25);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 2, 560);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 3, 13592);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 4, 317324);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 5, 7710115);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R w KQk - 0 1", 6, 185959088);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 1, 25);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 2, 560);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 3, 13607);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 4, 320792);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 5, 7848606);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R w KQq - 0 1", 6, 190755813);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 1, 5);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 2, 75);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 3, 459);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 4, 8290);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 5, 47635);
	result = result && checkPerft("4k3/8/8/8/8/8/8/4K2R b K - 0 1", 6, 899442);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 1, 5);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 2, 80);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 3, 493);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 4, 8897);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 5, 52710);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K3 b Q - 0 1", 6, 1001523);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 1, 15);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 2, 66);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 3, 1197);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 4, 7059);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 5, 133987);
	result = result && checkPerft("4k2r/8/8/8/8/8/8/4K3 b k - 0 1", 6, 764643);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 1, 16);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 2, 71);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 3, 1287);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 4, 7626);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 5, 145232);
	result = result && checkPerft("r3k3/8/8/8/8/8/8/4K3 b q - 0 1", 6, 846648);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 1, 5);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 2, 130);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 3, 782);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 4, 22180);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 5, 118882);
	result = result && checkPerft("4k3/8/8/8/8/8/8/R3K2R b KQ - 0 1", 6, 3517770);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 1, 26);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 2, 112);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 3, 3189);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 4, 17945);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 5, 532933);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/4K3 b kq - 0 1", 6, 2788982);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 1, 3);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 2, 32);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 3, 134);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 4, 2073);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 5, 10485);
	result = result && checkPerft("8/8/8/8/8/8/6k1/4K2R b K - 0 1", 6, 179869);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 1, 4);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 2, 49);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 3, 243);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 4, 3991);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 5, 20780);
	result = result && checkPerft("8/8/8/8/8/8/1k6/R3K3 b Q - 0 1", 6, 367724);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 1, 12);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 2, 38);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 3, 564);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 4, 2219);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 5, 37735);
	result = result && checkPerft("4k2r/6K1/8/8/8/8/8/8 b k - 0 1", 6, 185867);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 1, 15);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 2, 65);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 3, 1018);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 4, 4573);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 5, 80619);
	result = result && checkPerft("r3k3/1K6/8/8/8/8/8/8 b q - 0 1", 6, 413018);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 1, 26);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 2, 568);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 3, 13744);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 4, 314346);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 5, 7594526);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K2R b KQkq - 0 1", 6, 179862938);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 1, 26);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 2, 583);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 3, 14252);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 4, 334705);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 5, 8198901);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/1R2K2R b Kkq - 0 1", 6, 198328929);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 1, 25);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 2, 560);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 3, 13592);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 4, 317324);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 5, 7710115);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/2R1K2R b Kkq - 0 1", 6, 185959088);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 1, 25);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 2, 560);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 3, 13607);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 4, 320792);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 5, 7848606);
	result = result && checkPerft("r3k2r/8/8/8/8/8/8/R3K1R1 b Qkq - 0 1", 6, 190755813);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 1, 25);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 2, 567);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 3, 14095);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 4, 328965);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 5, 8153719);
	result = result && checkPerft("1r2k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 6, 195629489);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 1, 25);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 2, 548);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 3, 13502);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 4, 312835);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 5, 7736373);
	result = result && checkPerft("2r1k2r/8/8/8/8/8/8/R3K2R b KQk - 0 1", 6, 184411439);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 1, 25);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 2, 547);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 3, 13579);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 4, 316214);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 5, 7878456);
	result = result && checkPerft("r3k1r1/8/8/8/8/8/8/R3K2R b KQq - 0 1", 6, 189224276);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 1, 14);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 2, 195);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 3, 2760);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 4, 38675);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 5, 570726);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 w - - 0 1", 6, 8107539);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 1, 11);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 2, 156);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 3, 1636);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 4, 20534);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 5, 223507);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 w - - 0 1", 6, 2594412);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 1, 19);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 2, 289);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 3, 4442);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 4, 73584);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 5, 1198299);
	result = result && checkPerft("8/8/4k3/3Nn3/3nN3/4K3/8/8 w - - 0 1", 6, 19870403);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 1, 3);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 2, 51);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 3, 345);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 4, 5301);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 5, 38348);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N w - - 0 1", 6, 588695);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 1, 17);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 2, 54);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 3, 835);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 4, 5910);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 5, 92250);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n w - - 0 1", 6, 688780);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 1, 15);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 2, 193);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 3, 2816);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 4, 40039);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 5, 582642);
	result = result && checkPerft("8/1n4N1/2k5/8/8/5K2/1N4n1/8 b - - 0 1", 6, 8503277);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 1, 16);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 2, 180);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 3, 2290);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 4, 24640);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 5, 288141);
	result = result && checkPerft("8/1k6/8/5N2/8/4n3/8/2K5 b - - 0 1", 6, 3147566);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 1, 4);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 2, 68);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 3, 1118);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 4, 16199);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 5, 281190);
	result = result && checkPerft("8/8/3K4/3Nn3/3nN3/4k3/8/8 b - - 0 1", 6, 4405103);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 1, 17);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 2, 54);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 3, 835);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 4, 5910);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 5, 92250);
	result = result && checkPerft("K7/8/2n5/1n6/8/8/8/k6N b - - 0 1", 6, 688780);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 1, 3);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 2, 51);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 3, 345);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 4, 5301);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 5, 38348);
	result = result && checkPerft("k7/8/2N5/1N6/8/8/8/K6n b - - 0 1", 6, 588695);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 1, 17);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 2, 278);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 3, 4607);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 4, 76778);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 5, 1320507);
	result = result && checkPerft("B6b/8/8/8/2K5/4k3/8/b6B w - - 0 1", 6, 22823890);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 1, 21);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 2, 316);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 3, 5744);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 4, 93338);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 5, 1713368);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K w - - 0 1", 6, 28861171);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 1, 21);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 2, 144);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 3, 3242);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 4, 32955);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 5, 787524);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b w - - 0 1", 6, 7881673);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 1, 7);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 2, 143);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 3, 1416);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 4, 31787);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 5, 310862);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B w - - 0 1", 6, 7382896);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 1, 6);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 2, 106);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 3, 1829);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 4, 31151);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 5, 530585);
	result = result && checkPerft("B6b/8/8/8/2K5/5k2/8/b6B b - - 0 1", 6, 9250746);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 1, 17);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 2, 309);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 3, 5133);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 4, 93603);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 5, 1591064);
	result = result && checkPerft("8/8/1B6/7b/7k/8/2B1b3/7K b - - 0 1", 6, 29027891);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 1, 7);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 2, 143);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 3, 1416);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 4, 31787);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 5, 310862);
	result = result && checkPerft("k7/B7/1B6/1B6/8/8/8/K6b b - - 0 1", 6, 7382896);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 1, 21);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 2, 144);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 3, 3242);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 4, 32955);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 5, 787524);
	result = result && checkPerft("K7/b7/1b6/1b6/8/8/8/k6B b - - 0 1", 6, 7881673);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 1, 19);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 2, 275);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 3, 5300);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 4, 104342);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 5, 2161211);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K w - - 0 1", 6, 44956585);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 1, 36);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 2, 1027);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 3, 29215);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 4, 771461);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 5, 20506480);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R w - - 0 1", 6, 525169084);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 1, 19);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 2, 275);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 3, 5300);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 4, 104342);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 5, 2161211);
	result = result && checkPerft("7k/RR6/8/8/8/8/rr6/7K b - - 0 1", 6, 44956585);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 1, 36);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 2, 1027);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 3, 29227);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 4, 771368);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 5, 20521342);
	result = result && checkPerft("R6r/8/8/2K5/5k2/8/8/r6R b - - 0 1", 6, 524966748);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 1, 2);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 2, 36);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 3, 143);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 4, 3637);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 5, 14893);
	result = result && checkPerft("6kq/8/8/8/8/8/8/7K w - - 0 1", 6, 391507);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 1, 2);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 2, 36);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 3, 143);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 4, 3637);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 5, 14893);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 6, 391507);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 1, 6);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 2, 35);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 3, 495);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 4, 8349);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 5, 166741);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k w - - 0 1", 6, 3370175);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 1, 22);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 2, 43);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 3, 1015);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 4, 4167);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 5, 105749);
	result = result && checkPerft("6qk/8/8/8/8/8/8/7K b - - 0 1", 6, 419369);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 1, 2);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 2, 36);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 3, 143);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 4, 3637);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 5, 14893);
	result = result && checkPerft("6KQ/8/8/8/8/8/8/7k b - - 0 1", 6, 391507);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 1, 6);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 2, 35);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 3, 495);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 4, 8349);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 5, 166741);
	result = result && checkPerft("K7/8/8/3Q4/4q3/8/8/7k b - - 0 1", 6, 3370175);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 1, 3);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 2, 7);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 3, 43);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 4, 199);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 5, 1347);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 w - - 0 1", 6, 6249);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 1, 3);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 2, 7);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 3, 43);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 4, 199);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 5, 1347);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k w - - 0 1", 6, 6249);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 1, 1);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 2, 3);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 3, 12);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 4, 80);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 5, 342);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 w - - 0 1", 6, 2343);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 1, 1);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 2, 3);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 3, 12);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 4, 80);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 5, 342);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 w - - 0 1", 6, 2343);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 1, 7);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 2, 35);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 3, 210);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 4, 1091);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 5, 7028);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 w - - 0 1", 6, 34834);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 1, 1);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 2, 3);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 3, 12);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 4, 80);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 5, 342);
	result = result && checkPerft("8/8/8/8/8/K7/P7/k7 b - - 0 1", 6, 2343);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 1, 1);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 2, 3);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 3, 12);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 4, 80);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 5, 342);
	result = result && checkPerft("8/8/8/8/8/7K/7P/7k b - - 0 1", 6, 2343);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 1, 3);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 2, 7);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 3, 43);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 4, 199);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 5, 1347);
	result = result && checkPerft("K7/p7/k7/8/8/8/8/8 b - - 0 1", 6, 6249);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 1, 3);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 2, 7);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 3, 43);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 4, 199);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 5, 1347);
	result = result && checkPerft("7K/7p/7k/8/8/8/8/8 b - - 0 1", 6, 6249);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 1, 5);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 2, 35);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 3, 182);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 4, 1091);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 5, 5408);
	result = result && checkPerft("8/2k1p3/3pP3/3P2K1/8/8/8/8 b - - 0 1", 6, 34822);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 1, 2);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 2, 8);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 3, 44);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 4, 282);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 5, 1814);
	result = result && checkPerft("8/8/8/8/8/4k3/4P3/4K3 w - - 0 1", 6, 11848);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 1, 2);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 2, 8);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 3, 44);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 4, 282);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 5, 1814);
	result = result && checkPerft("4k3/4p3/4K3/8/8/8/8/8 b - - 0 1", 6, 11848);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 1, 3);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 2, 9);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 3, 57);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 4, 360);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 5, 1969);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 w - - 0 1", 6, 10724);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 1, 3);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 2, 9);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 3, 57);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 4, 360);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 5, 1969);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 w - - 0 1", 6, 10724);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 1, 5);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 2, 25);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 3, 180);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 4, 1294);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 5, 8296);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 w - - 0 1", 6, 53138);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 1, 8);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 2, 61);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 3, 483);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 4, 3213);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 5, 23599);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 w - - 0 1", 6, 157093);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 1, 8);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 2, 61);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 3, 411);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 4, 3213);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 5, 21637);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 w - - 0 1", 6, 158065);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 2, 15);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 3, 90);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 4, 534);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 5, 3450);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K w - - 0 1", 6, 20960);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 1, 3);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 2, 9);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 3, 57);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 4, 360);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 5, 1969);
	result = result && checkPerft("8/8/7k/7p/7P/7K/8/8 b - - 0 1", 6, 10724);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 1, 3);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 2, 9);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 3, 57);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 4, 360);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 5, 1969);
	result = result && checkPerft("8/8/k7/p7/P7/K7/8/8 b - - 0 1", 6, 10724);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 1, 5);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 2, 25);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 3, 180);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 4, 1294);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 5, 8296);
	result = result && checkPerft("8/8/3k4/3p4/3P4/3K4/8/8 b - - 0 1", 6, 53138);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 1, 8);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 2, 61);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 3, 411);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 4, 3213);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 5, 21637);
	result = result && checkPerft("8/3k4/3p4/8/3P4/3K4/8/8 b - - 0 1", 6, 158065);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 1, 8);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 2, 61);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 3, 483);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 4, 3213);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 5, 23599);
	result = result && checkPerft("8/8/3k4/3p4/8/3P4/3K4/8 b - - 0 1", 6, 157093);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 2, 15);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 3, 89);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 4, 537);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 5, 3309);
	result = result && checkPerft("k7/8/3p4/8/3P4/8/8/7K b - - 0 1", 6, 21104);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 1, 4);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 2, 19);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 3, 117);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 4, 720);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 5, 4661);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 w - - 0 1", 6, 32191);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 1, 5);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 2, 19);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 3, 116);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 4, 716);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 5, 4786);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 w - - 0 1", 6, 30980);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 1, 5);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 2, 22);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 3, 139);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 4, 877);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 5, 6112);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 w - - 0 1", 6, 41874);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 5, 4354);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 w - - 0 1", 6, 29679);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 1, 5);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 2, 22);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 3, 139);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 4, 877);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 5, 6112);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 w - - 0 1", 6, 41874);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 5, 4354);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 w - - 0 1", 6, 29679);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 1, 3);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 2, 15);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 3, 84);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 4, 573);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 5, 3013);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K w - - 0 1", 6, 22886);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 5, 4271);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K w - - 0 1", 6, 28662);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 1, 5);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 2, 19);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 3, 117);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 4, 720);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 5, 5014);
	result = result && checkPerft("7k/3p4/8/8/3P4/8/8/K7 b - - 0 1", 6, 32167);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 1, 4);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 2, 19);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 3, 117);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 4, 712);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 5, 4658);
	result = result && checkPerft("7k/8/8/3p4/8/8/3P4/K7 b - - 0 1", 6, 30749);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 1, 5);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 2, 22);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 3, 139);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 4, 877);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 5, 6112);
	result = result && checkPerft("k7/8/8/7p/6P1/8/8/K7 b - - 0 1", 6, 41874);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 5, 4354);
	result = result && checkPerft("k7/8/7p/8/8/6P1/8/K7 b - - 0 1", 6, 29679);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 1, 5);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 2, 22);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 3, 139);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 4, 877);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 5, 6112);
	result = result && checkPerft("k7/8/8/6p1/7P/8/8/K7 b - - 0 1", 6, 41874);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 5, 4354);
	result = result && checkPerft("k7/8/6p1/8/8/7P/8/K7 b - - 0 1", 6, 29679);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 1, 5);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 2, 15);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 3, 102);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 4, 569);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 5, 4337);
	result = result && checkPerft("k7/8/8/3p4/4p3/8/8/7K b - - 0 1", 6, 22579);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 1, 4);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 2, 16);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 3, 101);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 4, 637);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 5, 4271);
	result = result && checkPerft("k7/8/3p4/8/8/4P3/8/7K b - - 0 1", 6, 28662);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 1, 5);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 2, 22);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 3, 139);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 4, 877);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 5, 6112);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K w - - 0 1", 6, 41874);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 1, 4);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 2, 16);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 3, 101);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 4, 637);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 5, 4354);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K w - - 0 1", 6, 29679);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 1, 5);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 2, 22);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 3, 139);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 4, 877);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 5, 6112);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K w - - 0 1", 6, 41874);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 1, 4);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 2, 16);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 3, 101);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 4, 637);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 5, 4354);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K w - - 0 1", 6, 29679);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 1, 5);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 2, 25);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 3, 161);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 4, 1035);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 5, 7574);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 w - - 0 1", 6, 55338);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 1, 5);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 2, 25);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 3, 161);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 4, 1035);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 5, 7574);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 w - - 0 1", 6, 55338);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 1, 7);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 2, 49);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 3, 378);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 4, 2902);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 5, 24122);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 w - - 0 1", 6, 199002);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 1, 5);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 2, 22);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 3, 139);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 4, 877);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 5, 6112);
	result = result && checkPerft("7k/8/8/p7/1P6/8/8/7K b - - 0 1", 6, 41874);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 1, 4);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 2, 16);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 3, 101);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 4, 637);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 5, 4354);
	result = result && checkPerft("7k/8/p7/8/8/1P6/8/7K b - - 0 1", 6, 29679);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 1, 5);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 2, 22);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 3, 139);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 4, 877);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 5, 6112);
	result = result && checkPerft("7k/8/8/1p6/P7/8/8/7K b - - 0 1", 6, 41874);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 1, 4);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 2, 16);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 3, 101);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 4, 637);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 5, 4354);
	result = result && checkPerft("7k/8/1p6/8/8/P7/8/7K b - - 0 1", 6, 29679);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 1, 5);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 2, 25);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 3, 161);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 4, 1035);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 5, 7574);
	result = result && checkPerft("k7/7p/8/8/8/8/6P1/K7 b - - 0 1", 6, 55338);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 1, 5);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 2, 25);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 3, 161);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 4, 1035);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 5, 7574);
	result = result && checkPerft("k7/6p1/8/8/8/8/7P/K7 b - - 0 1", 6, 55338);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 1, 7);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 2, 49);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 3, 378);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 4, 2902);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 5, 24122);
	result = result && checkPerft("3k4/3pp3/8/8/8/8/3PP3/3K4 b - - 0 1", 6, 199002);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 1, 11);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 2, 97);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 3, 887);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 4, 8048);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 5, 90606);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 w - - 0 1", 6, 1030499);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 1, 24);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 2, 421);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 3, 7421);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 4, 124608);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 5, 2193768);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N w - - 0 1", 6, 37665329);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 1, 18);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 2, 270);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 3, 4699);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 4, 79355);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 5, 1533145);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 w - - 0 1", 6, 28859283);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 1, 24);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 2, 496);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 3, 9483);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 4, 182838);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 5, 3605103);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N w - - 0 1", 6, 71179139);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 1, 11);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 2, 97);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 3, 887);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 4, 8048);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 5, 90606);
	result = result && checkPerft("8/Pk6/8/8/8/8/6Kp/8 b - - 0 1", 6, 1030499);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 1, 24);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 2, 421);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 3, 7421);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 4, 124608);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 5, 2193768);
	result = result && checkPerft("n1n5/1Pk5/8/8/8/8/5Kp1/5N1N b - - 0 1", 6, 37665329);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 1, 18);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 2, 270);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 3, 4699);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 4, 79355);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 5, 1533145);
	result = result && checkPerft("8/PPPk4/8/8/8/8/4Kppp/8 b - - 0 1", 6, 28859283);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 1, 24);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 2, 496);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 3, 9483);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 4, 182838);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 5, 3605103);
	result = result && checkPerft("n1n5/PPPk4/8/8/8/8/4Kppp/5N1N b - - 0 1", 6, 71179139);
	if (result) cout << "Done OK" << endl; else cout << "Error!" << endl;
	cout << "Runtime: " << setprecision(3) << perftRuntime.count() / 1000000.0 << " s" << endl;
	cout << "Count:   " << setprecision(3) << perftNodes / 1000000.0 << " MNodes" << endl;
	cout << setprecision(3) << (1.0 * perftNodes) / perftRuntime.count() << " MNodes/s" << endl;
	return result;
}